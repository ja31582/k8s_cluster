kubectl apply -f https://raw.githubusercontent.com/metallb/metallb/v0.15.3/config/manifests/metallb-native.yaml


#konfiguracja puli adresowej IP oraz reklamy L2 dla MetalLB
---
apiVersion: metallb.io/v1beta1
kind: IPAddressPool
metadata:
  name: my-ip-pool
  namespace: metallb-system
spec:
  addresses:
  - 10.0.0.70-10.0.0.80
---
apiVersion: metallb.io/v1beta1
kind: L2Advertisement
metadata:
  name: l2-advert
  namespace: metallb-system
spec:
  ipAddressPools:
  - my-ip-pool


kubectl apply -f metallb-config.yaml




# Pobierz najnowszą wersję (sprawdź najnowszą tutaj: https://github.com/argoproj/argo-cd/releases)
VERSION=$(curl --silent "https://api.github.com/repos/argoproj/argo-cd/releases/latest" | grep '"tag_name":' | sed -E 's/.*"v([^"]+)".*/\1/')
curl -sSL -o argocd https://github.com/argoproj/argo-cd/releases/download/v$VERSION/argocd-linux-amd64
chmod +x argocd
sudo mv argocd /usr/local/bin/

#sprawdzenie wersji
argocd version

#logowanie do ArgoCD
argocd login 10.0.0.80 --username admin --password kaLIst01! --insecure

#dodanie repozytorium
argocd repo add https://github.com/uzytkownik/nazwarepo.git

#sprawdzenie dodanych repozytoriów
argocd repo list

---
example-

repo: k8s_cluster
├─ metal-lb/
├─ grafana/
├─ nginx/

#utworzenie aplikacji ArgoCD dla MetalLB
argocd app create loadbalancer-app \
  --repo https://github.com/ja31582/k8s_cluster.git \
  --path ./metal-lb \
  --dest-server https://kubernetes.default.svc \
  --dest-namespace metallb-system \
  --sync-policy automated

#utworzenie aplikacji ArgoCD dla Grafana
argocd app create grafana-app \
  --repo https://github.com/ja31582/k8s_cluster.git \
  --path ./grafana \
  --dest-server https://kubernetes.default.svc \
  --dest-namespace monitoring \
  --sync-policy automated


argocd app create k8s-dashboard-app \
  --repo https://github.com/ja31582/k8s_cluster.git \
  --path ./k8s-dashboard \
  --dest-server https://kubernetes.default.svc \
  --dest-namespace kubernetes-dashboard \
  --sync-policy automated  
---
#listowanie aplikacji
argocd app list

#sprawdzenie statusu aplikacji
argocd app get loadbalancer-app






